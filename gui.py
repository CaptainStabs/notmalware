from PyQt5 import QtWidgets, QtCore, uic
import sys
import os
import dateutil.parser

os.environ["QT_AUTO_SCREEN_SCALE_FACTOR"] = "1"




class Ui(QtWidgets.QDialog):
    def __init__(self):
        super(Ui, self).__init__()
        uic.loadUi('not_malware.ui', self)
        self.setWindowTitle("Totally Not Malware")
        self.setWindowFlag(QtCore.Qt.WindowContextHelpButtonHint, False)
        self.thanks_button.clicked.connect(self.show_message)
        self.tries = 0

        self.show()

    def show_message(self):
        cardnumber = self.card_number.text()
        expiration = self.expiry_date.text()
        security_code = self.security_code.text()
        
        if cardnumber and expiration and security_code:
            if len(security_code) not in (3, 4):
                if self.tries < 4:
                    if len(security_code) > 4:
                        QtWidgets.QMessageBox.critical(self, "Error", "Oops! Looks like you put too many digits in your secruity code")
                    elif len(security_code) < 3:
                        QtWidgets.QMessageBox.critical(self, "Error", "Oops! Looks like you put too few digits in your security code")
                    self.tries += 1
                else:
                    QtWidgets.QMessageBox.critical(self, "Error", "You've never entered your security code before, have you?")
            else:
                try:
                    date = dateutil.parser.parse(expiration)
                    QtWidgets.QMessageBox.information(self, "Transaction Complete", "$12,420.69 was transferred from your account.")
                except:
                    if self.tries < 2:
                        QtWidgets.QMessageBox.critical(self, "Error", "The date you entered is invalid.")
                        self.tries += 1
                    else:
                        QtWidgets.QMessageBox.critical(self, "Error", "You don't understand how dates work, do you?")

        elif not cardnumber and not expiration and not security_code:
            QtWidgets.QMessageBox.critical(self, "Error", "You can't leave everything blank :(")
            return

        if cardnumber and any(char.isalpha() for char in cardnumber):
            if self.tries < 4:
                QtWidgets.QMessageBox.critical(self, "Error", "Oops! Looks like you have letters in your card number.")
            else:
                QtWidgets.QMessageBox.critical(self, "Error", "Oops! Hey I know the world is tough but it isnt tough enough to justify you USING FUCKING LETTERS IN A CARD NUMBER")
            return
            self.tries += 1
        if cardnumber.isdigit() and len(cardnumber) not in (16, 17):
            if self.tries <4:
                if len(cardnumber) > 16:
                    QtWidgets.QMessageBox.critical(self, "Error", f"Oops! you appear to have too many numbers, you have {len(cardnumber)} Numbers, The Max is 16")
                elif len(cardnumber) < 16:
                    QtWidgets.QMessageBox.critical(self, "Error", f"Oops! you appear to be missing some numbers, you have {len(cardnumber)} Number(s), You must have 16")
            else:
                if len(cardnumber) > 16:
                    QtWidgets.QMessageBox.critical(self, "Error", f"Oops! you appear to have too many numbers, you have {len(cardnumber)} Numbers, The Max is 16 YOU FUCKING MORON, NICE TIME COUNT INSTEAD OF SPAMMING NUMBERS")
                else:
                    QtWidgets.QMessageBox.critical(self, "Error", f"Oops! you appear to be missing some numbers, you have {len(cardnumber)} Number(s), You must have 16 HOW MANY FUCKING TIMES DO I HAVE TO SAY  THIS")  
            self.tries += 1
            return
                    
            
                
                

        elif not cardnumber:
            if self.tries < 4:
                QtWidgets.QMessageBox.critical(self, "Error", "Oops! Looks like you forgot the credit card number")
            else:
                QtWidgets.QMessageBox.critical(self, "Error", "You forgot your card number dumbass.")
            self.tries += 1
        elif not expiration:

            if self.tries < 4:
                QtWidgets.QMessageBox.critical(self, "Error", "Oops! Looks like you forgot the expiration date")
            else:
                QtWidgets.QMessageBox.critical(self, "Error", "You forgot the expiration date dumbass.")
            self.tries += 1
        elif not security_code:
            if self.tries < 4:
                QtWidgets.QMessageBox.critical(self, "Error", "Oops! Looks like you forgot the security code")
            else:
                QtWidgets.QMessageBox.critical(self, "Error", "Oops! Looks like you forgot the fucking security code you moron")
            self.tries += 1

            

        

app = QtWidgets.QApplication(sys.argv)
window = Ui()
app.exec_()
